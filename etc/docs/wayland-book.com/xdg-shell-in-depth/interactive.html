<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Interactive move and resize - The Wayland Protocol</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="../">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body class="light">
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../introduction/high-level-design.html"><strong aria-hidden="true">1.1.</strong> High-level Wayland design</a></li><li class="chapter-item expanded "><a href="../introduction/goals.html"><strong aria-hidden="true">1.2.</strong> Goals & target audience</a></li><li class="chapter-item expanded "><a href="../introduction/package.html"><strong aria-hidden="true">1.3.</strong> What's in the package</a></li></ol></li><li class="chapter-item expanded "><a href="../protocol-design.html"><strong aria-hidden="true">2.</strong> Protocol design</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../protocol-design/wire-protocol.html"><strong aria-hidden="true">2.1.</strong> Wire protocol basics</a></li><li class="chapter-item expanded "><a href="../protocol-design/interfaces-reqs-events.html"><strong aria-hidden="true">2.2.</strong> Interfaces, requests, events</a></li><li class="chapter-item expanded "><a href="../protocol-design/high-level.html"><strong aria-hidden="true">2.3.</strong> The high-level protocol</a></li><li class="chapter-item expanded "><a href="../protocol-design/design-patterns.html"><strong aria-hidden="true">2.4.</strong> Protocol design patterns</a></li></ol></li><li class="chapter-item expanded "><a href="../libwayland.html"><strong aria-hidden="true">3.</strong> libwayland in depth</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../libwayland/util.html"><strong aria-hidden="true">3.1.</strong> wayland-util primitives</a></li><li class="chapter-item expanded "><a href="../libwayland/wayland-scanner.html"><strong aria-hidden="true">3.2.</strong> wayland-scanner</a></li><li class="chapter-item expanded "><a href="../libwayland/proxies.html"><strong aria-hidden="true">3.3.</strong> Proxies & resources</a></li><li class="chapter-item expanded "><a href="../libwayland/interfaces.html"><strong aria-hidden="true">3.4.</strong> Interfaces & listeners</a></li></ol></li><li class="chapter-item expanded "><a href="../wayland-display.html"><strong aria-hidden="true">4.</strong> The Wayland display</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../wayland-display/creation.html"><strong aria-hidden="true">4.1.</strong> Creating a display</a></li><li class="chapter-item expanded "><a href="../wayland-display/event-loop.html"><strong aria-hidden="true">4.2.</strong> Incorporating an event loop</a></li></ol></li><li class="chapter-item expanded "><a href="../registry.html"><strong aria-hidden="true">5.</strong> Globals & the registry</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../registry/binding.html"><strong aria-hidden="true">5.1.</strong> Binding to globals</a></li><li class="chapter-item expanded "><a href="../registry/server-side.html"><strong aria-hidden="true">5.2.</strong> Registering globals</a></li></ol></li><li class="chapter-item expanded "><a href="../surfaces.html"><strong aria-hidden="true">6.</strong> Buffers & surfaces</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../surfaces/compositor.html"><strong aria-hidden="true">6.1.</strong> Using wl_compositor</a></li><li class="chapter-item expanded "><a href="../surfaces/shared-memory.html"><strong aria-hidden="true">6.2.</strong> Shared memory buffers</a></li><li class="chapter-item expanded "><a href="../surfaces/dmabuf.html"><strong aria-hidden="true">6.3.</strong> Linux dmabuf</a></li><li class="chapter-item expanded "><a href="../surfaces/roles.html"><strong aria-hidden="true">6.4.</strong> Surface roles</a></li></ol></li><li class="chapter-item expanded "><a href="../xdg-shell-basics.html"><strong aria-hidden="true">7.</strong> XDG shell basics</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../xdg-shell-basics/xdg-surface.html"><strong aria-hidden="true">7.1.</strong> XDG surfaces</a></li><li class="chapter-item expanded "><a href="../xdg-shell-basics/xdg-toplevel.html"><strong aria-hidden="true">7.2.</strong> Application windows</a></li><li class="chapter-item expanded "><a href="../xdg-shell-basics/example-code.html"><strong aria-hidden="true">7.3.</strong> Extended example code</a></li></ol></li><li class="chapter-item expanded "><a href="../surfaces-in-depth.html"><strong aria-hidden="true">8.</strong> Surfaces in depth</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../surfaces-in-depth/lifecycle.html"><strong aria-hidden="true">8.1.</strong> Surface lifecycle</a></li><li class="chapter-item expanded "><a href="../surfaces-in-depth/frame-callbacks.html"><strong aria-hidden="true">8.2.</strong> Frame callbacks</a></li><li class="chapter-item expanded "><a href="../surfaces-in-depth/damaging-surfaces.html"><strong aria-hidden="true">8.3.</strong> Damaging surfaces</a></li><li class="chapter-item expanded "><a href="../surfaces-in-depth/surface-regions.html"><strong aria-hidden="true">8.4.</strong> Surface regions</a></li><li class="chapter-item expanded "><a href="../surfaces-in-depth/subsurfaces.html"><strong aria-hidden="true">8.5.</strong> Subsurfaces</a></li><li class="chapter-item expanded "><a href="../surfaces-in-depth/hidpi.html"><strong aria-hidden="true">8.6.</strong> High density surfaces (HiDPI)</a></li></ol></li><li class="chapter-item expanded "><a href="../seat.html"><strong aria-hidden="true">9.</strong> Seats: Handling input</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../seat/pointer.html"><strong aria-hidden="true">9.1.</strong> Pointer input</a></li><li class="chapter-item expanded "><a href="../seat/xkb.html"><strong aria-hidden="true">9.2.</strong> XKB, briefly</a></li><li class="chapter-item expanded "><a href="../seat/keyboard.html"><strong aria-hidden="true">9.3.</strong> Keyboard input</a></li><li class="chapter-item expanded "><a href="../seat/touch.html"><strong aria-hidden="true">9.4.</strong> Touch input</a></li><li class="chapter-item expanded "><a href="../seat/example.html"><strong aria-hidden="true">9.5.</strong> Expanding our example code</a></li></ol></li><li class="chapter-item expanded "><a href="../xdg-shell-in-depth.html"><strong aria-hidden="true">10.</strong> XDG shell in depth</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../xdg-shell-in-depth/configuration.html"><strong aria-hidden="true">10.1.</strong> Configuration & lifecycle</a></li><li class="chapter-item expanded "><a href="../xdg-shell-in-depth/popups.html"><strong aria-hidden="true">10.2.</strong> Popups & parent windows</a></li><li class="chapter-item expanded "><a href="../xdg-shell-in-depth/interactive.html" class="active"><strong aria-hidden="true">10.3.</strong> Interactive move and resize</a></li><li class="chapter-item expanded "><a href="../xdg-shell-in-depth/positioners.html"><strong aria-hidden="true">10.4.</strong> Positioners</a></li></ol></li><li class="chapter-item expanded "><a href="../clipboard.html"><strong aria-hidden="true">11.</strong> Clipboard access</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../clipboard/data-offers.html"><strong aria-hidden="true">11.1.</strong> Data offers</a></li><li class="chapter-item expanded "><a href="../clipboard/dnd.html"><strong aria-hidden="true">11.2.</strong> Drag & drop</a></li></ol></li><li class="chapter-item expanded "><a href="../protocol-extensions.html"><strong aria-hidden="true">12.</strong> Protocol extensions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../protocol-extensions/timing.html"><strong aria-hidden="true">12.1.</strong> Accurate timing</a></li><li class="chapter-item expanded "><a href="../protocol-extensions/pointer-constraints.html"><strong aria-hidden="true">12.2.</strong> Pointer constraints</a></li><li class="chapter-item expanded "><a href="../protocol-extensions/clipboard.html"><strong aria-hidden="true">12.3.</strong> Extended clipboard support</a></li><li class="chapter-item expanded "><a href="../protocol-extensions/desktop-shell.html"><strong aria-hidden="true">12.4.</strong> Desktop shell components</a></li><li class="chapter-item expanded "><a href="../protocol-extensions/misc.html"><strong aria-hidden="true">12.5.</strong> Miscellaneous extensions</a></li><li class="chapter-item expanded "><a href="../protocol-extensions/writing.html"><strong aria-hidden="true">12.6.</strong> Writing new extensions</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="../acknowledgements.html">Acknowledgements</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <h1 class="menu-title">The Wayland Protocol</h1>

                        <div class="right-buttons">
                            <a href="../print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="interactive-move-and-resize"><a class="header" href="#interactive-move-and-resize">Interactive move and resize</a></h1>
<p>Many application windows have interactive UI elements the user can use to drag
around or resize windows. Many Wayland clients, by default, expect to be
responsible for their own window decorations to provide these interactive
elements. On X11, application windows could position themselves independently
anywhere on the screen, and used this to facilitate these interactions.</p>
<p>However, a deliberate design trait of Wayland makes application windows ignorant
of their exact placement on screen or relative to other windows. This decision
affords Wayland compositors a greater deal of flexibility — windows could 
be shown in several places at once, arranged in the 3D space of a VR scene, or
presented in any other novel way. Wayland is designed to be generic and widely
applicable to many devices and form factors.</p>
<p>To balance these two design needs, XDG toplevels offer two requests which can be
used to ask the compositor to begin an interactive move or resize operation. The
relevant parts of the interface are:</p>
<pre><code class="language-xml">&lt;request name=&quot;move&quot;&gt;
  &lt;arg name=&quot;seat&quot; type=&quot;object&quot; interface=&quot;wl_seat&quot; /&gt;
  &lt;arg name=&quot;serial&quot; type=&quot;uint&quot; /&gt;
&lt;/request&gt;
</code></pre>
<p>Like the popup creation request explained in the previous chapter, you have to
provide an input event serial to start an interactive operation. For example,
when you receive a mouse button down event, you can use that event's serial to
begin an interactive move operation. The compositor will take over from here,
and begin an interactive operation to your window in its internal coordinate
space.</p>
<p>Resizing is a bit more complex, due to the need to specify which edges or
corners of the window are implicated in the operation:</p>
<pre><code class="language-xml">&lt;enum name=&quot;resize_edge&quot;&gt;
  &lt;entry name=&quot;none&quot; value=&quot;0&quot;/&gt;
  &lt;entry name=&quot;top&quot; value=&quot;1&quot;/&gt;
  &lt;entry name=&quot;bottom&quot; value=&quot;2&quot;/&gt;
  &lt;entry name=&quot;left&quot; value=&quot;4&quot;/&gt;
  &lt;entry name=&quot;top_left&quot; value=&quot;5&quot;/&gt;
  &lt;entry name=&quot;bottom_left&quot; value=&quot;6&quot;/&gt;
  &lt;entry name=&quot;right&quot; value=&quot;8&quot;/&gt;
  &lt;entry name=&quot;top_right&quot; value=&quot;9&quot;/&gt;
  &lt;entry name=&quot;bottom_right&quot; value=&quot;10&quot;/&gt;
&lt;/enum&gt;

&lt;request name=&quot;resize&quot;&gt;
  &lt;arg name=&quot;seat&quot; type=&quot;object&quot; interface=&quot;wl_seat&quot; /&gt;
  &lt;arg name=&quot;serial&quot; type=&quot;uint&quot; /&gt;
  &lt;arg name=&quot;edges&quot; type=&quot;uint&quot; /&gt;
&lt;/request&gt;
</code></pre>
<p>But otherwise, it functions much the same. If the user clicks and drags along
the bottom-left corner of your window, you may want to send an interactive
resize request with the corresponding seat &amp; serial, and set the edges argument
to bottom_left.</p>
<p>There's one additional request necessary for clients to totally implement
interactive client-side window decorations:</p>
<pre><code class="language-xml">&lt;request name=&quot;show_window_menu&quot;&gt;
  &lt;arg name=&quot;seat&quot; type=&quot;object&quot; interface=&quot;wl_seat&quot; /&gt;
  &lt;arg name=&quot;serial&quot; type=&quot;uint&quot; /&gt;
  &lt;arg name=&quot;x&quot; type=&quot;int&quot; /&gt;
  &lt;arg name=&quot;y&quot; type=&quot;int&quot; /&gt;
&lt;/request&gt;
</code></pre>
<p>A contextual menu offering window operations, such as closing or minimizing the
window, is often raised when clicking on window decorations. For clients where
window decorations are managed by the client, this serves to link the
client-driven interactions with compositor-driven meta operations like
minimizing windows. If your client uses client-side decorations, you may use
this request for this purpose.</p>
<h2 id="xdg-decoration"><a class="header" href="#xdg-decoration">xdg-decoration</a></h2>
<p>The last detail which bears mentioning when discussing the behavior of
client-side decorations is the protocol which governs the negotiation of their
use in the first place. Different Wayland clients and servers may have different
preferences about the use of server-side or client-side window decorations. To
express these intentions, a protocol extension is used: <code>xdg-decoration</code>. It can
be found in wayland-protocols. The protocol provides a global:</p>
<pre><code class="language-xml">&lt;interface name=&quot;zxdg_decoration_manager_v1&quot; version=&quot;1&quot;&gt;
  &lt;request name=&quot;destroy&quot; type=&quot;destructor&quot; /&gt;

  &lt;request name=&quot;get_toplevel_decoration&quot;&gt;
    &lt;arg name=&quot;id&quot; type=&quot;new_id&quot; interface=&quot;zxdg_toplevel_decoration_v1&quot;/&gt;
    &lt;arg name=&quot;toplevel&quot; type=&quot;object&quot; interface=&quot;xdg_toplevel&quot;/&gt;
  &lt;/request&gt;
&lt;/interface&gt;
</code></pre>
<p>You may pass your xdg_toplevel object into the <code>get_toplevel_decoration</code> request
to obtain an object with the following interface:</p>
<pre><code class="language-xml">&lt;interface name=&quot;zxdg_toplevel_decoration_v1&quot; version=&quot;1&quot;&gt;
  &lt;request name=&quot;destroy&quot; type=&quot;destructor&quot; /&gt;

  &lt;enum name=&quot;mode&quot;&gt;
    &lt;entry name=&quot;client_side&quot; value=&quot;1&quot; /&gt;
    &lt;entry name=&quot;server_side&quot; value=&quot;2&quot; /&gt;
  &lt;/enum&gt;

  &lt;request name=&quot;set_mode&quot;&gt;
    &lt;arg name=&quot;mode&quot; type=&quot;uint&quot; enum=&quot;mode&quot; /&gt;
  &lt;/request&gt;

  &lt;request name=&quot;unset_mode&quot; /&gt;

  &lt;event name=&quot;configure&quot;&gt;
    &lt;arg name=&quot;mode&quot; type=&quot;uint&quot; enum=&quot;mode&quot; /&gt;
  &lt;/event&gt;
&lt;/interface&gt;
</code></pre>
<p>The <code>set_mode</code> request is used to express a preference from the client, and
<code>unset_mode</code> is used to express no preference. The compositor will then use the
<code>configure</code> event to tell the client whether or not to use client-side
decorations. For more details, consult the full XML.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../xdg-shell-in-depth/popups.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../xdg-shell-in-depth/positioners.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a href="../xdg-shell-in-depth/popups.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a href="../xdg-shell-in-depth/positioners.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>


        <script src="../book.js" type="text/javascript" charset="utf-8"></script>


    </body>
</html>
